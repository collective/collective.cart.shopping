Log in as Manager::

    >>> browser.login(TEST_USER_NAME, TEST_USER_PASSWORD)

Assign cart portlet to shop::

    >>> browser.open('/shop/++contextportlets++plone.leftcolumn/+/collective.cart.core.CartPortlet')

Log out::

    >>> browser.getLink('Log out').click()

Go to Ärticle1::

    >>> browser.open('/shop/article1')

Add Ärticle1 to cart::

    >>> browser.getControl(name="form.buttons.AddToCart").click()

Go to cart::

    >>> browser.getLink('Go to cart').click()

Check out::

    >>> browser.getControl(name="form.checkout").click()

Fill Billing Info and select Shipping Methöd 2::

    >>> browser.getControl(name="first_name").value = 'Billing First Näme'
    >>> browser.getControl(name="last_name").value = 'Billing Last Näme'
    >>> browser.getControl(name="organization").value = 'Billing Örganization'
    >>> browser.getControl(name="vat").value = 'Fı1234567890'
    >>> browser.getControl(name="email").value = 'first.last@email.bil'
    >>> browser.getControl(name="street").value = 'Billing Street Äddress'
    >>> browser.getControl(name="post").value = 'Billing Pöst Cöde'
    >>> browser.getControl(name="city").value = 'Billing €ity'
    >>> browser.getControl(name="phone").value = 'Billing Phöne Number'
    >>> browser.getControl(name="shipping-method").value = [shippingmethod2_uuid]
    >>> browser.getControl(name="form.to.confirmation").click()

Confirm order::

    >>> browser.getControl(name="form.buttons.ConfirmOrder").click()

Thanks page::

    >>> 'Check the order' not in browser.contents
    True

Check the newest message sent::

    >>> len(mailhost.messages)
    1

    >>> msg = mailhost.messages[-1]
    >>> prink(msg)
    MIME-Version: 1.0
    Content-Type: text/plain; charset="utf-8"
    Content-Transfer-Encoding: quoted-printable
    CC: info@shop.com
    Subject: =?utf-8?q?Order_Number=3A_1?=
    To: first.last@email.bil
    From: info@shop.com
    Date: ...
    <BLANKLINE>
    Thank you for the order.
    <BLANKLINE>
    Order Number: 1
    <BLANKLINE>
    Billing Address
    =3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
    =3D=3D=3D
    Billing First N=C3=A4me Billing Last N=C3=A4me  Billing =C3=96rganization  =
    F=C4=B11234567890
    Billing Street =C3=84ddress
    Billing P=C3=B6st C=C3=B6de Billing =E2=82=ACity
    Billing Ph=C3=B6ne Number
    first.last@email.bil
    <BLANKLINE>
    <BLANKLINE>
    Shipping Address
    =3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
    =3D=3D=3D
    Billing First N=C3=A4me Billing Last N=C3=A4me  Billing =C3=96rganization  =
    F=C4=B11234567890
    Billing Street =C3=84ddress
    Billing P=C3=B6st C=C3=B6de Billing =E2=82=ACity
    Billing Ph=C3=B6ne Number
    first.last@email.bil
    <BLANKLINE>
    <BLANKLINE>
    Ordered contents
    =3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=3D=
    =3D=3D=3D
    <BLANKLINE>
    <BLANKLINE>
    Shipping Method:   0.00 =E2=82=AC
    <BLANKLINE>
    Total: 0.00 =E2=82=AC
    <BLANKLINE>
    Link to the order: http://nohost/plone/shop/cart-container/1

Go to Ärticle1::

    >>> browser.open('/shop/article1')

Add Ärticle1 to cart::

    >>> browser.getControl(name="form.buttons.AddToCart").click()

Go to cart::

    >>> browser.getLink('Go to cart').click()

Check out and there should be billing info filled::

    >>> browser.getControl(name="form.checkout").click()

    >>> 'value="Billing First Näme"' in browser.contents
    True
    >>> 'value="Billing Last Näme"' in browser.contents
    True
    >>> 'value="Billing Örganization"' in browser.contents
    True
    >>> 'value="Fı1234567890"' in browser.contents
    True
    >>> 'value="first.last@email.bil"' in browser.contents
    True
    >>> 'value="Billing Street Äddress"' in browser.contents
    True
    >>> 'value="Billing Pöst Cöde"' in browser.contents
    True
    >>> 'value="Billing €ity"' in browser.contents
    True
    >>> 'value="Billing Phöne Number"' in browser.contents
    True
    >>> print browser.bycss('.shipping-methods')
        --- 1 ---
    ...
    <input name="shipping-method" type="radio" required="required" checked value="..."><span>ShippingMeth&#246;d2  0.00 EUR</span>
    ...
